{
  "{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\SaiMadhu's PC\\\\Nodeprojects\\\\NodeAssignments\\\\Module6\\\\\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"C:\\\\Users\\\\SaiMadhu's PC\\\\Nodeprojects\\\\NodeAssignments\\\\Module6\",\"filename\":\"C:\\\\Users\\\\SaiMadhu's PC\\\\Nodeprojects\\\\NodeAssignments\\\\Module6\\\\app.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\SaiMadhu's PC\\\\Nodeprojects\\\\NodeAssignments\\\\Module6\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.14.3": {
    "metadata": {},
    "options": {
      "assumptions": {},
      "sourceRoot": "C:\\Users\\SaiMadhu's PC\\Nodeprojects\\NodeAssignments\\Module6\\",
      "caller": {
        "name": "@babel/register"
      },
      "cwd": "C:\\Users\\SaiMadhu's PC\\Nodeprojects\\NodeAssignments\\Module6",
      "filename": "C:\\Users\\SaiMadhu's PC\\Nodeprojects\\NodeAssignments\\Module6\\app.js",
      "targets": {},
      "cloneInputAst": true,
      "babelrc": false,
      "configFile": false,
      "browserslistConfigFile": false,
      "envName": "development",
      "root": "C:\\Users\\SaiMadhu's PC\\Nodeprojects\\NodeAssignments\\Module6",
      "rootMode": "root",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "C:\\Users\\SaiMadhu's PC\\Nodeprojects\\NodeAssignments\\Module6\\app.js",
        "plugins": []
      },
      "generatorOpts": {
        "filename": "C:\\Users\\SaiMadhu's PC\\Nodeprojects\\NodeAssignments\\Module6\\app.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "C:\\Users\\SaiMadhu's PC\\Nodeprojects\\NodeAssignments\\Module6\\",
        "sourceFileName": "app.js"
      }
    },
    "ast": null,
    "code": "const express = require('express');\n\nconst bodyParser = require('body-parser');\n\nconst app = express();\nconst port = process.env.port || 3000;\napp.use(express.static(__dirname + '/public'));\napp.use(bodyParser.urlencoded({\n  extended: true\n}));\napp.use(bodyParser.json());\napp.set('view engine', 'ejs');\napp.set('views', './views');\n\nconst MongoClient = require('mongodb').MongoClient;\n\nconst mongoUrl = 'mongodb://127.0.0.1:27017';\nconst dbName = 'dbmodule6';\nconst collectionName = 'buglist';\nlet db;\n\nconst ObjectId = require('mongodb').ObjectID;\n\napp.post('/addBug', (req, res) => {\n  const rec = req.body;\n  rec[\"createTime\"] = Date.now();\n  rec[\"closeTime\"] = ''; //console.log(\"bug ==> \", rec)\n\n  db.collection(collectionName).insertOne(rec).then(result => {\n    //res.status(200).send(\"New order inserted ... check /orderDashboard \")\n    //console.log(\"result : \", result.ops)\n    res.redirect(\"/\");\n  }).catch(err => {\n    console.error(`Error Message : ${err}`);\n    res.status(500).send(`Error Message : ${err}`);\n  });\n}); //Get data from db and display on index.ejs\n\napp.get('/', (req, res) => {\n  db.collection(collectionName).find().toArray((err, result) => {\n    if (err) throw err; //console.log(\"result ==> \", result)\n\n    let status;\n    const bugs = result.map(bug => {\n      console.log(\"bug ==> \", bug);\n      const slaTime = bug.createTime + 259200000;\n\n      if (bug.closeTime.length == '') {\n        status = \"OPEN\";\n      } else {\n        status = \"CLOSE\";\n        bug[\"closeTimeStr\"] = new Date(bug.closeTime).toLocaleString();\n      }\n\n      bug[\"createTimeStr\"] = new Date(bug.createTime).toLocaleString();\n      bug[\"slaTimeStr\"] = new Date(slaTime).toLocaleString();\n      bug[\"status\"] = status;\n      return bug;\n    }); //console.log(\"bugs ==> \", bugs)\n\n    res.render('index.ejs', {\n      data: bugs\n    });\n  });\n});\napp.get('/deleteBug/:id', (req, res) => {\n  const id = req.params.id;\n  console.log(\"delete id ==> \", id);\n  db.collection(collectionName).findOneAndDelete({\n    _id: ObjectId(id)\n  }, (err, result) => {\n    if (err) return res.send(500, err);\n    res.redirect('/');\n    console.log(\"deleteBug result ==> \", result);\n  });\n});\napp.get('/closeBug/:id', (req, res) => {\n  const id = req.params.id;\n  console.log(\"id ==> \", id);\n  db.collection(collectionName).findOne({\n    _id: ObjectId(id)\n  }).then(result => {\n    //console.log(\"result ==> \", result)\n    db.collection(collectionName).findOneAndUpdate({\n      _id: ObjectId(result._id)\n    }, {\n      $set: {\n        title: result.title,\n        assignee: result.assignee,\n        description: result.description,\n        createTime: result.createTime,\n        closeTime: Date.now()\n      }\n    }, {\n      upsert: true\n    }, (err, result) => {\n      if (err) return res.send(err);\n      res.redirect('/');\n    });\n  }).catch(err => console.error(`Error : ${err}`));\n});\nMongoClient.connect(mongoUrl, {\n  useNewUrlParser: true\n}, (err, client) => {\n  if (err) throw err;\n  db = client.db(dbName);\n  app.listen(port, () => {\n    console.log(`Express Server running on port ${port}`);\n  });\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsImJvZHlQYXJzZXIiLCJhcHAiLCJwb3J0IiwicHJvY2VzcyIsImVudiIsInVzZSIsInN0YXRpYyIsIl9fZGlybmFtZSIsInVybGVuY29kZWQiLCJleHRlbmRlZCIsImpzb24iLCJzZXQiLCJNb25nb0NsaWVudCIsIm1vbmdvVXJsIiwiZGJOYW1lIiwiY29sbGVjdGlvbk5hbWUiLCJkYiIsIk9iamVjdElkIiwiT2JqZWN0SUQiLCJwb3N0IiwicmVxIiwicmVzIiwicmVjIiwiYm9keSIsIkRhdGUiLCJub3ciLCJjb2xsZWN0aW9uIiwiaW5zZXJ0T25lIiwidGhlbiIsInJlc3VsdCIsInJlZGlyZWN0IiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiLCJzdGF0dXMiLCJzZW5kIiwiZ2V0IiwiZmluZCIsInRvQXJyYXkiLCJidWdzIiwibWFwIiwiYnVnIiwibG9nIiwic2xhVGltZSIsImNyZWF0ZVRpbWUiLCJjbG9zZVRpbWUiLCJsZW5ndGgiLCJ0b0xvY2FsZVN0cmluZyIsInJlbmRlciIsImRhdGEiLCJpZCIsInBhcmFtcyIsImZpbmRPbmVBbmREZWxldGUiLCJfaWQiLCJmaW5kT25lIiwiZmluZE9uZUFuZFVwZGF0ZSIsIiRzZXQiLCJ0aXRsZSIsImFzc2lnbmVlIiwiZGVzY3JpcHRpb24iLCJ1cHNlcnQiLCJjb25uZWN0IiwidXNlTmV3VXJsUGFyc2VyIiwiY2xpZW50IiwibGlzdGVuIl0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxPQUFPLEdBQUdDLE9BQU8sQ0FBRSxTQUFGLENBQXZCOztBQUNBLE1BQU1DLFVBQVUsR0FBR0QsT0FBTyxDQUFDLGFBQUQsQ0FBMUI7O0FBRUEsTUFBTUUsR0FBRyxHQUFHSCxPQUFPLEVBQW5CO0FBQ0EsTUFBTUksSUFBSSxHQUFHQyxPQUFPLENBQUNDLEdBQVIsQ0FBWUYsSUFBWixJQUFvQixJQUFqQztBQUVBRCxHQUFHLENBQUNJLEdBQUosQ0FB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QUFMLEtBQWM7QUFDbkUsTUFBR2hDLEdBQUgsRUFBUSxNQUFNQSxHQUFOO0FBQ1JoQixFQUFBQSxFQUFFLEdBQUdnRCxNQUFNLENBQUNoRCxFQUFQLENBQVVGLE1BQVYsQ0FBTDtBQUNBYixFQUFBQSxHQUFHLENBQUNnRSxNQUFKLENBQVcvRCxJQUFYLEVBQWlCLE1BQUk7QUFDakIrQixJQUFBQSxPQUFPLENBQUNVLEdBQVIsQ0FBYSxrQ0FBaUN6QyxJQUFLLEVBQW5EO0FBQ0gsR0FGRDtBQUdILENBTkQiLCJzb3VyY2VSb290IjoiQzpcXFVzZXJzXFxTYWlNYWRodSdzIFBDXFxOb2RlcHJvamVjdHNcXE5vZGVBc3NpZ25tZW50c1xcTW9kdWxlNlxcIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZXhwcmVzcyA9IHJlcXVpcmUgKCdleHByZXNzJyk7XHJcbmNvbnN0IGJvZHlQYXJzZXIgPSByZXF1aXJlKCdib2R5LXBhcnNlcicpO1xyXG5cclxuY29uc3QgYXBwID0gZXhwcmVzcygpO1xyXG5jb25zdCBwb3J0ID0gcHJvY2Vzcy5lbnYucG9ydCB8fCAzMDAwO1xyXG5cclxuYXBwLnVzZShleHByZXNzLnN0YXRpYyhfX2Rpcm5hbWUrJy9wdWJsaWMnKSlcclxuXHJcbmFwcC51c2UoYm9keVBhcnNlci51cmxlbmNvZGVkKHtleHRlbmRlZDp0cnVlfSkpXHJcbmFwcC51c2UoYm9keVBhcnNlci5qc29uKCkpXHJcblxyXG5hcHAuc2V0KCd2aWV3IGVuZ2luZScsICdlanMnKVxyXG5hcHAuc2V0KCd2aWV3cycsICcuL3ZpZXdzJylcclxuXHJcbmNvbnN0IE1vbmdvQ2xpZW50ID0gcmVxdWlyZSgnbW9uZ29kYicpLk1vbmdvQ2xpZW50XHJcbmNvbnN0IG1vbmdvVXJsID0gJ21vbmdvZGI6Ly8xMjcuMC4wLjE6MjcwMTcnXHJcbmNvbnN0IGRiTmFtZSA9ICdkYm1vZHVsZTYnXHJcbmNvbnN0IGNvbGxlY3Rpb25OYW1lID0gJ2J1Z2xpc3QnXHJcbmxldCBkYlxyXG5cclxuY29uc3QgT2JqZWN0SWQgPSByZXF1aXJlKCdtb25nb2RiJykuT2JqZWN0SURcclxuXHJcbmFwcC5wb3N0KCcvYWRkQnVnJywgKHJlcSxyZXMpPT57XHJcbiAgICBjb25zdCByZWMgPSByZXEuYm9keVxyXG4gICAgcmVjW1wiY3JlYXRlVGltZVwiXSA9IERhdGUubm93KClcclxuICAgIHJlY1tcImNsb3NlVGltZVwiXSA9ICcnXHJcbiAgICAvL2NvbnNvbGUubG9nKFwiYnVnID09PiBcIiwgcmVjKVxyXG5cclxuICAgIGRiLmNvbGxlY3Rpb24oY29sbGVjdGlvbk5hbWUpLmluc2VydE9uZShyZWMpXHJcbiAgICAgICAgLnRoZW4oIHJlc3VsdCA9PiB7XHJcbiAgICAgICAgICAgIC8vcmVzLnN0YXR1cygyMDApLnNlbmQoXCJOZXcgb3JkZXIgaW5zZXJ0ZWQgLi4uIGNoZWNrIC9vcmRlckRhc2hib2FyZCBcIilcclxuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcInJlc3VsdCA6IFwiLCByZXN1bHQub3BzKVxyXG4gICAgICAgICAgICByZXMucmVkaXJlY3QoXCIvXCIpXHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goZXJyID0+IHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgTWVzc2FnZSA6ICR7ZXJyfWApXHJcbiAgICAgICAgICAgIHJlcy5zdGF0dXMoNTAwKS5zZW5kKGBFcnJvciBNZXNzYWdlIDogJHtlcnJ9YClcclxuICAgICAgICB9KVxyXG4gICAgXHJcbn0pXHJcblxyXG4vL0dldCBkYXRhIGZyb20gZGIgYW5kIGRpc3BsYXkgb24gaW5kZXguZWpzXHJcbmFwcC5nZXQoJy8nLCAocmVxLHJlcyk9PntcclxuICAgIGRiLmNvbGxlY3Rpb24oY29sbGVjdGlvbk5hbWUpLmZpbmQoKS50b0FycmF5KChlcnIsIHJlc3VsdCk9PntcclxuICAgICAgICBpZihlcnIpIHRocm93IGVyclxyXG4gICAgICAgIC8vY29uc29sZS5sb2coXCJyZXN1bHQgPT0+IFwiLCByZXN1bHQpXHJcbiAgICAgICAgbGV0IHN0YXR1c1xyXG4gICAgICAgIGNvbnN0IGJ1Z3MgPSByZXN1bHQubWFwKCBidWcgPT57XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiYnVnID09PiBcIiwgYnVnKVxyXG4gICAgICAgICAgICBjb25zdCBzbGFUaW1lID0gYnVnLmNyZWF0ZVRpbWUgKyAyNTkyMDAwMDBcclxuXHJcbiAgICAgICAgICAgIGlmKCBidWcuY2xvc2VUaW1lLmxlbmd0aCA9PSAnJyApIHtcclxuICAgICAgICAgICAgICAgIHN0YXR1cyA9IFwiT1BFTlwiXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBzdGF0dXMgPSBcIkNMT1NFXCJcclxuICAgICAgICAgICAgICAgIGJ1Z1tcImNsb3NlVGltZVN0clwiXSA9IG5ldyBEYXRlKGJ1Zy5jbG9zZVRpbWUpLnRvTG9jYWxlU3RyaW5nKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBidWdbXCJjcmVhdGVUaW1lU3RyXCJdID0gbmV3IERhdGUoYnVnLmNyZWF0ZVRpbWUpLnRvTG9jYWxlU3RyaW5nKClcclxuICAgICAgICAgICAgYnVnW1wic2xhVGltZVN0clwiXSA9IG5ldyBEYXRlKHNsYVRpbWUpLnRvTG9jYWxlU3RyaW5nKClcclxuICAgICAgICAgICAgYnVnW1wic3RhdHVzXCJdID0gc3RhdHVzXHJcbiAgICAgICAgICAgIHJldHVybiBidWdcclxuICAgICAgICB9KVxyXG4gICAgICAgIC8vY29uc29sZS5sb2coXCJidWdzID09PiBcIiwgYnVncylcclxuICAgICAgICByZXMucmVuZGVyKCdpbmRleC5lanMnLCB7ZGF0YTpidWdzfSlcclxuICAgIH0pXHJcbn0pXHJcblxyXG5hcHAuZ2V0KCcvZGVsZXRlQnVnLzppZCcsIChyZXEscmVzKT0+e1xyXG4gICAgY29uc3QgaWQgPSByZXEucGFyYW1zLmlkXHJcbiAgICBjb25zb2xlLmxvZyhcImRlbGV0ZSBpZCA9PT4gXCIsIGlkKVxyXG5cclxuICAgIGRiLmNvbGxlY3Rpb24oY29sbGVjdGlvbk5hbWUpLmZpbmRPbmVBbmREZWxldGUoe1xyXG4gICAgICAgIF9pZDogT2JqZWN0SWQoaWQpXHJcbiAgICB9LCAoZXJyLHJlc3VsdCk9PntcclxuICAgICAgICBpZihlcnIpIHJldHVybiByZXMuc2VuZCg1MDAsZXJyKVxyXG4gICAgICAgIHJlcy5yZWRpcmVjdCgnLycpXHJcbiAgICAgICAgY29uc29sZS5sb2coXCJkZWxldGVCdWcgcmVzdWx0ID09PiBcIiwgcmVzdWx0KVxyXG4gICAgfSlcclxuXHJcbn0pXHJcblxyXG5hcHAuZ2V0KCcvY2xvc2VCdWcvOmlkJywgKHJlcSxyZXMpPT57XHJcbiAgICBjb25zdCBpZCA9IHJlcS5wYXJhbXMuaWRcclxuICAgIGNvbnNvbGUubG9nKFwiaWQgPT0+IFwiLCBpZClcclxuICAgIFxyXG4gICAgZGIuY29sbGVjdGlvbihjb2xsZWN0aW9uTmFtZSkuZmluZE9uZSgge19pZDogT2JqZWN0SWQoaWQpfSApXHJcbiAgICAgICAgLnRoZW4ocmVzdWx0ID0+e1xyXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwicmVzdWx0ID09PiBcIiwgcmVzdWx0KVxyXG4gICAgICAgICAgICBkYi5jb2xsZWN0aW9uKGNvbGxlY3Rpb25OYW1lKVxyXG4gICAgICAgICAgICAgICAgLmZpbmRPbmVBbmRVcGRhdGUoe19pZDogT2JqZWN0SWQocmVzdWx0Ll9pZCl9LHtcclxuICAgICAgICAgICAgICAgICAgICAkc2V0OntcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGUgOiByZXN1bHQudGl0bGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlIDogcmVzdWx0LmFzc2lnbmVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiA6IHJlc3VsdC5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlVGltZSA6IHJlc3VsdC5jcmVhdGVUaW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbG9zZVRpbWU6IERhdGUubm93KCksXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSx7XHJcbiAgICAgICAgICAgICAgICAgICAgdXBzZXJ0OiB0cnVlXHJcbiAgICAgICAgICAgICAgICB9LCAoZXJyLHJlc3VsdCk9PntcclxuICAgICAgICAgICAgICAgICAgICBpZihlcnIpIHJldHVybiByZXMuc2VuZChlcnIpXHJcbiAgICAgICAgICAgICAgICAgICAgcmVzLnJlZGlyZWN0KCcvJylcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goIGVyciA9PiBjb25zb2xlLmVycm9yKGBFcnJvciA6ICR7ZXJyfWApKVxyXG5cclxufSlcclxuXHJcbk1vbmdvQ2xpZW50LmNvbm5lY3QobW9uZ29VcmwsIHsgdXNlTmV3VXJsUGFyc2VyOiB0cnVlIH0sIChlcnIsY2xpZW50KT0+e1xyXG4gICAgaWYoZXJyKSB0aHJvdyBlcnJcclxuICAgIGRiID0gY2xpZW50LmRiKGRiTmFtZSlcclxuICAgIGFwcC5saXN0ZW4ocG9ydCwgKCk9PntcclxuICAgICAgICBjb25zb2xlLmxvZyhgRXhwcmVzcyBTZXJ2ZXIgcnVubmluZyBvbiBwb3J0ICR7cG9ydH1gKVxyXG4gICAgfSlcclxufSkiXX0=",
    "map": {
      "version": 3,
      "sources": [
        "app.js"
      ],
      "names": [
        "express",
        "require",
        "bodyParser",
        "app",
        "port",
        "process",
        "env",
        "use",
        "static",
        "__dirname",
        "urlencoded",
        "extended",
        "json",
        "set",
        "MongoClient",
        "mongoUrl",
        "dbName",
        "collectionName",
        "db",
        "ObjectId",
        "ObjectID",
        "post",
        "req",
        "res",
        "rec",
        "body",
        "Date",
        "now",
        "collection",
        "insertOne",
        "then",
        "result",
        "redirect",
        "catch",
        "err",
        "console",
        "error",
        "status",
        "send",
        "get",
        "find",
        "toArray",
        "bugs",
        "map",
        "bug",
        "log",
        "slaTime",
        "createTime",
        "closeTime",
        "length",
        "toLocaleString",
        "render",
        "data",
        "id",
        "params",
        "findOneAndDelete",
        "_id",
        "findOne",
        "findOneAndUpdate",
        "$set",
        "title",
        "assignee",
        "description",
        "upsert",
        "connect",
        "useNewUrlParser",
        "client",
        "listen"
      ],
      "mappings": "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",
      "sourceRoot": "C:\\Users\\SaiMadhu's PC\\Nodeprojects\\NodeAssignments\\Module6\\",
      "sourcesContent": [
        "const express = require ('express');\r\nconst bodyParser = require('body-parser');\r\n\r\nconst app = express();\r\nconst port = process.env.port || 3000;\r\n\r\napp.use(express.static(__dirname+'/public'))\r\n\r\napp.use(bodyParser.urlencoded({extended:true}))\r\napp.use(bodyParser.json())\r\n\r\napp.set('view engine', 'ejs')\r\napp.set('views', './views')\r\n\r\nconst MongoClient = require('mongodb').MongoClient\r\nconst mongoUrl = 'mongodb://127.0.0.1:27017'\r\nconst dbName = 'dbmodule6'\r\nconst collectionName = 'buglist'\r\nlet db\r\n\r\nconst ObjectId = require('mongodb').ObjectID\r\n\r\napp.post('/addBug', (req,res)=>{\r\n    const rec = req.body\r\n    rec[\"createTime\"] = Date.now()\r\n    rec[\"closeTime\"] = ''\r\n    //console.log(\"bug ==> \", rec)\r\n\r\n    db.collection(collectionName).insertOne(rec)\r\n        .then( result => {\r\n            //res.status(200).send(\"New order inserted ... check /orderDashboard \")\r\n            //console.log(\"result : \", result.ops)\r\n            res.redirect(\"/\")\r\n        })\r\n        .catch(err => {\r\n            console.error(`Error Message : ${err}`)\r\n            res.status(500).send(`Error Message : ${err}`)\r\n        })\r\n    \r\n})\r\n\r\n//Get data from db and display on index.ejs\r\napp.get('/', (req,res)=>{\r\n    db.collection(collectionName).find().toArray((err, result)=>{\r\n        if(err) throw err\r\n        //console.log(\"result ==> \", result)\r\n        let status\r\n        const bugs = result.map( bug =>{\r\n            console.log(\"bug ==> \", bug)\r\n            const slaTime = bug.createTime + 259200000\r\n\r\n            if( bug.closeTime.length == '' ) {\r\n                status = \"OPEN\"\r\n            } else {\r\n                status = \"CLOSE\"\r\n                bug[\"closeTimeStr\"] = new Date(bug.closeTime).toLocaleString()\r\n            }\r\n            bug[\"createTimeStr\"] = new Date(bug.createTime).toLocaleString()\r\n            bug[\"slaTimeStr\"] = new Date(slaTime).toLocaleString()\r\n            bug[\"status\"] = status\r\n            return bug\r\n        })\r\n        //console.log(\"bugs ==> \", bugs)\r\n        res.render('index.ejs', {data:bugs})\r\n    })\r\n})\r\n\r\napp.get('/deleteBug/:id', (req,res)=>{\r\n    const id = req.params.id\r\n    console.log(\"delete id ==> \", id)\r\n\r\n    db.collection(collectionName).findOneAndDelete({\r\n        _id: ObjectId(id)\r\n    }, (err,result)=>{\r\n        if(err) return res.send(500,err)\r\n        res.redirect('/')\r\n        console.log(\"deleteBug result ==> \", result)\r\n    })\r\n\r\n})\r\n\r\napp.get('/closeBug/:id', (req,res)=>{\r\n    const id = req.params.id\r\n    console.log(\"id ==> \", id)\r\n    \r\n    db.collection(collectionName).findOne( {_id: ObjectId(id)} )\r\n        .then(result =>{\r\n            //console.log(\"result ==> \", result)\r\n            db.collection(collectionName)\r\n                .findOneAndUpdate({_id: ObjectId(result._id)},{\r\n                    $set:{\r\n                        title : result.title,\r\n                        assignee : result.assignee,\r\n                        description : result.description,\r\n                        createTime : result.createTime,\r\n                        closeTime: Date.now(),\r\n                    }\r\n                },{\r\n                    upsert: true\r\n                }, (err,result)=>{\r\n                    if(err) return res.send(err)\r\n                    res.redirect('/')\r\n                })\r\n        })\r\n        .catch( err => console.error(`Error : ${err}`))\r\n\r\n})\r\n\r\nMongoClient.connect(mongoUrl, { useNewUrlParser: true }, (err,client)=>{\r\n    if(err) throw err\r\n    db = client.db(dbName)\r\n    app.listen(port, ()=>{\r\n        console.log(`Express Server running on port ${port}`)\r\n    })\r\n})"
      ]
    },
    "sourceType": "module",
    "mtime": 1621550855465
  }
}